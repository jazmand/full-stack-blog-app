(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{106:function(e,t,n){},107:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(10),i=n.n(c),o=n(18),s=n(23),u=n(49),l=n(63),d=n(8),j=n.n(d),b=n(14),f=function(e){setTimeout((function(){e({type:"REMOVE_MESSAGE"})}),5e3)},h=function(e){return function(){var t=Object(b.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"SET_MESSAGE",data:{text:e,type:"fulfilled"}}),f(n);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},O=function(e){return function(){var t=Object(b.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"SET_MESSAGE",data:{text:e,type:"error"}}),f(n);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_MESSAGE":return t.data;case"REMOVE_MESSAGE":return null;default:return e}},v=n(52),m=n(70),g=n(26),x=n.n(g),y=n(64),w="/api/blogs",k=null,E={setToken:function(e){k="bearer ".concat(e)},getAll:function(){return x.a.get(w).then((function(e){return e.data}))},create:function(){var e=Object(b.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:k}},e.next=3,x.a.post(w,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(b.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:k}},e.next=3,x.a.put("".concat(w,"/").concat(t.id),{likes:t.likes,config:n});case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:k}},e.next=3,x.a.delete("".concat(w,"/").concat(t.id),n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getAllUsers:function(){var e={headers:{Authorization:k}};return x.a.get("/api/users",e).then((function(e){return e.data}))},getUserInfo:function(){return!!k&&Object(y.a)(k)},newComment:function(){var e=Object(b.a)(j.a.mark((function e(t,n){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.post("".concat(w,"/").concat(t,"/comments"),{comment:n});case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOGS":return t.data;case"CREATE_BLOG":return[].concat(Object(m.a)(e),[t.data]);case"LIKE_BLOG":return e.map((function(e){return e.id===t.data.id?Object(v.a)(Object(v.a)({},e),{},{likes:t.data.likes}):e}));case"DELETE_BLOG":return e.filter((function(e){return e.id!==t.data.id}));case"COMMENT_BLOG":return e.map((function(e){return e.id!==t.data.id?e:t.data}));default:return e}},N={login:function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},L=function(){var e=window.localStorage.getItem("loggedBlogappUser");if(e){var t=JSON.parse(e);return E.setToken(t.token),{type:"LOGIN_USER",data:t}}return{type:"LOGOUT_USER"}},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_USER":return t.data;case"LOGOUT_USER":return null;default:return e}},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_USERS":return t.data;default:return e}},U=Object(u.b)({blogs:S,notification:p,user:C,allUsers:T}),G=Object(u.c)(U,Object(u.a)(l.a)),B=n(13),_=n(5),A=n(137),I=n(142),R=n(143),M=n(150),z=n(144),D=n(109),J=n(145),V=n(147),W=n(22),F=n(140),K=n(108),H=n(152),P=n(151),q=n(2),Q=function(e){var t=e.blog;if(!t)return Object(q.jsx)("p",{children:"Loading..."});var n=Object(o.b)(),a=Object(B.f)(),c=Object(r.useState)(!1),i=Object(W.a)(c,2),s=i[0],u=i[1];Object(r.useEffect)((function(){var e=E.getUserInfo(),n=t.user.id||t.user;u(n===e.id)}),[]);var l=Object(A.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)}}}}))();return Object(q.jsxs)("div",{children:[Object(q.jsx)("h1",{className:"title",children:t.title}),Object(q.jsxs)("div",{className:"info",children:[Object(q.jsx)(F.a,{href:t.id,underline:"hover",variant:"h6",children:t.url}),Object(q.jsxs)(K.a,{variant:"h5",className:l.root,children:[Object(q.jsxs)("span",{className:"likes",children:[t.likes," likes"]}),Object(q.jsx)(H.a,{className:"like",onClick:function(){try{n((e=t.id,r=t.likes+1,function(){var t=Object(b.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E.update({id:e,likes:r});case 2:n({type:"LIKE_BLOG",data:{id:e,likes:r}});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),n(h("new like to blog ".concat(t.title," by ").concat(t.author)))}catch(a){n(O(a))}var e,r},variant:"contained",color:"primary",children:"Like"})]}),Object(q.jsxs)(K.a,{className:"author",children:["added by ",t.author]}),s&&Object(q.jsx)("button",{className:"remove",onClick:function(){var e;if(window.confirm("Remove ".concat(t.title," by ").concat(t.author,"?")))try{n(h("blog ".concat(t.title," by ").concat(t.author," delete"))),n((e=t.id,function(){var t=Object(b.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E.remove({id:e});case 2:n({type:"DELETE_BLOG",data:{id:e}});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),a.push("/")}catch(r){n(O(r))}},children:"remove"})]}),Object(q.jsxs)("div",{className:"comments",children:[Object(q.jsx)("h3",{children:"Comments"}),Object(q.jsxs)("form",{onSubmit:function(e){var r,a;e.preventDefault(),n((r=t.id,a=e.target.comment.value,function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.newComment(r,a);case 2:n=e.sent,t({type:"COMMENT_BLOG",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),e.target.comment.value=""},className:l.root,children:[Object(q.jsx)(P.a,{label:"Add Comment",variant:"outlined",type:"text",name:"comment"}),Object(q.jsx)("div",{children:Object(q.jsx)(H.a,{type:"submit",variant:"contained",color:"primary",children:"Submit"})})]}),Object(q.jsx)("ul",{children:t.comments?t.comments.map((function(e){return Object(q.jsx)("li",{children:e},e)})):Object(q.jsx)("div",{children:" No comments "})})]})]})},X=function(e){var t=e.message;return null===t?null:Object(q.jsx)(K.a,{className:"message message-".concat(t.type),children:t.text})},Y=function(){var e=Object(o.b)(),t=Object(r.useState)(""),n=Object(W.a)(t,2),a=n[0],c=n[1],i=Object(r.useState)(""),s=Object(W.a)(i,2),u=s[0],l=s[1],d=Object(A.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)}}}}))();return Object(q.jsx)("div",{children:Object(q.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e(function(e,t){return function(){var n=Object(b.a)(j.a.mark((function n(r){var a;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,N.login({username:e,password:t});case 3:a=n.sent,window.localStorage.setItem("loggedBlogappUser",JSON.stringify(a)),E.setToken(a.token),r(L()),r(h("".concat(a.username," successfully logged in"))),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(0),r(O("Incorrect credentials"));case 13:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(e){return n.apply(this,arguments)}}()}(a,u)),c(""),l("")},className:d.root,children:[Object(q.jsx)("div",{children:Object(q.jsx)(P.a,{label:"Username",variant:"outlined",id:"username",value:a,onChange:function(e){var t=e.target;return c(t.value)}})}),Object(q.jsx)("div",{children:Object(q.jsx)(P.a,{label:"Password",variant:"outlined",id:"password",type:"password",value:u,onChange:function(e){var t=e.target;return l(t.value)}})}),Object(q.jsx)(H.a,{id:"login-button",type:"submit",variant:"contained",color:"primary",children:"Login"})]})})},Z=function(e){var t=e.createBlog,n=Object(r.useState)(""),a=Object(W.a)(n,2),c=a[0],i=a[1],o=Object(r.useState)(""),s=Object(W.a)(o,2),u=s[0],l=s[1],d=Object(r.useState)(""),j=Object(W.a)(d,2),b=j[0],f=j[1],h=Object(A.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)}}}}))();return Object(q.jsx)("div",{className:"blogFormDiv",children:Object(q.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t({title:c,author:u,url:b}),i(""),l(""),f("")},className:h.root,children:[Object(q.jsx)("div",{children:Object(q.jsx)(P.a,{label:"Title",variant:"outlined",id:"title",value:c,name:"title",onChange:function(e){var t=e.target;return i(t.value)}})}),Object(q.jsx)("div",{children:Object(q.jsx)(P.a,{label:"Author",variant:"outlined",id:"author",value:u,name:"author",onChange:function(e){var t=e.target;return l(t.value)}})}),Object(q.jsx)("div",{children:Object(q.jsx)(P.a,{label:"Url",variant:"outlined",id:"url",value:b,name:"url",onChange:function(e){var t=e.target;return f(t.value)}})}),Object(q.jsx)(H.a,{id:"create-blog",type:"submit",variant:"contained",color:"primary",children:"Create"})]})})},$=a.a.forwardRef((function(e,t){var n=Object(r.useState)(!1),a=Object(W.a)(n,2),c=a[0],i=a[1],o={display:c?"none":""},s={display:c?"":"none"},u=function(){i(!c)};Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:u}}));var l=Object(A.a)((function(e){return{spacing:{marginLeft:e.spacing(1)}}}))();return Object(q.jsxs)("div",{children:[Object(q.jsx)("div",{style:o,children:Object(q.jsx)(H.a,{className:l.spacing,id:"create-blog",type:"submit",variant:"contained",color:"primary",onClick:u,children:e.buttonLabel})}),Object(q.jsxs)("div",{style:s,children:[e.children,Object(q.jsx)(H.a,{className:l.spacing,variant:"contained",color:"primary",onClick:u,children:"Cancel"})]})]})}));$.displayName="Togglable";var ee=$,te=n(146),ne=Object(_.a)((function(e){return{head:{backgroundColor:e.palette.warning.light,color:e.palette.common.white},body:{fontSize:14}}}))(I.a),re=Object(_.a)((function(e){return{root:{"&:nth-of-type(odd)":{backgroundColor:e.palette.action.hover}}}}))(R.a),ae=Object(A.a)({table:{minWidth:700}}),ce=function(){var e=ae(),t=Object(o.b)(),n=Object(o.c)((function(e){return e.allUsers})),a=Object(o.c)((function(e){return e.blogs}));return Object(r.useEffect)((function(){t(function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.getAllUsers();case 2:n=e.sent,t({type:"GET_USERS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[a]),Object(q.jsxs)("div",{className:"users",children:[Object(q.jsx)("h2",{children:"Users"}),n&&Object(q.jsx)(z.a,{component:D.a,children:Object(q.jsxs)(J.a,{className:e.table,"aria-label":"customized table",children:[Object(q.jsx)(te.a,{children:Object(q.jsxs)(R.a,{children:[Object(q.jsx)(ne,{children:"User Name"}),Object(q.jsx)(ne,{align:"right",children:"Blogs Created"})]})}),Object(q.jsx)(V.a,{children:n.map((function(e){return Object(q.jsxs)(re,{children:[Object(q.jsx)(ne,{component:"th",scope:"row",children:Object(q.jsx)(s.b,{to:"/users/".concat(e.id),children:e.name})}),Object(q.jsx)(ne,{align:"right",children:e.blogs.length})]},e.name)}))})]})})]})},ie=function(e){var t=e.blogs;if(!t[0])return Object(q.jsx)("p",{children:"Loading..."});var n=Object(A.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)}}}}))();return Object(q.jsxs)("div",{children:[Object(q.jsx)("h2",{children:t[0].user.name}),Object(q.jsx)(K.a,{children:"Added blogs"}),Object(q.jsx)("ul",{children:t.map((function(e){return Object(q.jsx)("li",{className:n.root,children:Object(q.jsx)(F.a,{href:"/blogs/".concat(e.id),underline:"hover",variant:"h6",children:e.title})},e.id)}))})]})},oe=n(148),se=n(149),ue=function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.user})),n=Object(B.f)(),r=Object(A.a)((function(e){return{title:{flexGrow:1},logoutButton:{marginLeft:e.spacing(2)},link:{textDecoration:"none",color:"#fff",paddingRight:"1em"},loggedText:{color:"grey"}}}))();return Object(q.jsx)("div",{children:Object(q.jsx)(oe.a,{position:"static",children:Object(q.jsx)(se.a,{children:null!==t?Object(q.jsxs)(q.Fragment,{children:[Object(q.jsxs)(K.a,{variant:"h6",className:r.title,children:[Object(q.jsx)(s.b,{className:r.link,to:"/blogs",children:"Blogs"}),Object(q.jsx)(s.b,{className:r.link,to:"/users",children:"Users"})]}),Object(q.jsxs)(K.a,{variant:"overline",className:r.loggedText,children:[t.name," logged in"]}),Object(q.jsx)(H.a,{variant:"outlined",color:"secondary",className:r.logoutButton,onClick:function(){e((window.localStorage.removeItem("loggedBlogappUser"),{type:"LOGOUT_USER"})),n.push("/")},children:"Logout"})]}):Object(q.jsx)(K.a,{variant:"h5",children:"Login"})})})})},le=function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.blogs})),n=Object(o.c)((function(e){return e.notification})),a=Object(o.c)((function(e){return e.user})),c=Object(r.useRef)();Object(r.useEffect)((function(){e(L())}),[e]),Object(r.useEffect)((function(){e(function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[e]);var i=Object(B.g)("/users/:id"),u=i?t.filter((function(e){return e.user.id===i.params.id})):null,l=Object(B.g)("/blogs/:id"),d=l?t.find((function(e){return e.id===l.params.id})):null,f=Object(_.a)((function(e){return{head:{backgroundColor:e.palette.warning.light,color:e.palette.common.white},body:{fontSize:14}}}))(I.a),p=Object(_.a)((function(e){return{root:{"&:nth-of-type(odd)":{backgroundColor:e.palette.action.hover}}}}))(R.a),v=Object(A.a)({table:{minWidth:700}})();return Object(q.jsxs)(M.a,{maxWidth:"xl",children:[Object(q.jsx)(ue,{}),Object(q.jsx)(X,{message:n}),Object(q.jsxs)(B.c,{children:[Object(q.jsx)(B.a,{path:"/users/:id",children:Object(q.jsx)(ie,{blogs:u})}),Object(q.jsx)(B.a,{path:"/blogs/:id",children:Object(q.jsx)(Q,{blog:d})}),Object(q.jsx)(B.a,{path:"/users",children:null===a?Object(q.jsx)(Y,{}):Object(q.jsx)(ce,{})}),Object(q.jsx)(B.a,{path:"/",children:null===a?Object(q.jsx)("div",{children:Object(q.jsx)(Y,{})}):Object(q.jsxs)("div",{children:[Object(q.jsx)("h2",{children:"Blogs"}),Object(q.jsx)(ee,{buttonLabel:"Create Blog",ref:c,children:Object(q.jsx)(Z,{createBlog:function(t){c.current.toggleVisibility(),e(function(e){return function(){var t=Object(b.a)(j.a.mark((function t(n){var r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,E.create(e);case 3:r=t.sent,n({type:"CREATE_BLOG",data:r}),n(h("a new blog ".concat(e.title," by ").concat(e.author," added"))),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),n(O("All fields must be filled in"));case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()}(t))}})}),Object(q.jsx)(z.a,{component:D.a,children:Object(q.jsx)(J.a,{className:v.table,"aria-label":"customized table",children:Object(q.jsx)(V.a,{children:t.sort((function(e,t){return e.likes>t.likes?-1:1})).map((function(e){return Object(q.jsx)(p,{children:Object(q.jsx)(f,{component:"th",scope:"row",children:Object(q.jsx)(s.b,{to:"/blogs/".concat(e.id),children:e.title})})},e.id)}))})})})]})})]})]})};n(106);i.a.render(Object(q.jsx)(o.a,{store:G,children:Object(q.jsx)(s.a,{children:Object(q.jsx)(le,{})})}),document.getElementById("root"))}},[[107,1,2]]]);
//# sourceMappingURL=main.8c632a49.chunk.js.map