(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{106:function(e,t,n){},107:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(10),i=n.n(c),s=n(18),o=n(24),u=n(49),l=n(63),d=n(7),j=n.n(d),b=n(12),f=function(e){setTimeout((function(){e({type:"REMOVE_MESSAGE"})}),5e3)},h=function(e){return function(){var t=Object(b.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"SET_MESSAGE",data:{text:e,type:"fulfilled"}}),f(n);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},p=function(e){return function(){var t=Object(b.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"SET_MESSAGE",data:{text:e,type:"error"}}),f(n);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_MESSAGE":return t.data;case"REMOVE_MESSAGE":return null;default:return e}},v=n(52),m=n(70),x=n(23),g=n.n(x),y=n(64),w="/api/blogs",k=null,E={setToken:function(e){k="bearer ".concat(e)},getAll:function(){return g.a.get(w).then((function(e){return e.data}))},create:function(){var e=Object(b.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:k}},e.next=3,g.a.post(w,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(b.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:k}},e.next=3,g.a.put("".concat(w,"/").concat(t.id),{likes:t.likes,config:n});case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:k}},e.next=3,g.a.delete("".concat(w,"/").concat(t.id),n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getAllUsers:function(){var e={headers:{Authorization:k}};return g.a.get("/api/users",e).then((function(e){return e.data}))},getUserInfo:function(){return!!k&&Object(y.a)(k)},newComment:function(){var e=Object(b.a)(j.a.mark((function e(t,n){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.post("".concat(w,"/").concat(t,"/comments"),{comment:n});case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOGS":return t.data;case"CREATE_BLOG":return[].concat(Object(m.a)(e),[t.data]);case"LIKE_BLOG":return e.map((function(e){return e.id===t.data.id?Object(v.a)(Object(v.a)({},e),{},{likes:t.data.likes}):e}));case"DELETE_BLOG":return e.filter((function(e){return e.id!==t.data.id}));case"COMMENT_BLOG":return e.map((function(e){return e.id!==t.data.id?e:t.data}));default:return e}},N={login:function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},C={createUser:function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.post("/api/users",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},U=function(){var e=window.localStorage.getItem("loggedBlogappUser");if(e){var t=JSON.parse(e);return E.setToken(t.token),{type:"LOGIN_USER",data:t}}return{type:"LOGOUT_USER"}},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_USER":return t.data;case"LOGOUT_USER":case"CREATE_USER":return null;default:return e}},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_USERS":return t.data;default:return e}},B=Object(u.b)({blogs:S,notification:O,user:L,allUsers:T}),A=Object(u.c)(B,Object(u.a)(l.a)),_=n(14),G=n(5),R=n(137),I=n(142),M=n(143),D=n(150),z=n(144),F=n(109),J=n(145),V=n(147),W=n(19),K=n(140),P=n(108),q=n(152),H=n(151),Q=n(2),X=function(e){var t=e.blog;if(!t)return Object(Q.jsx)("p",{children:"Loading..."});var n=Object(s.b)(),a=Object(_.f)(),c=Object(r.useState)(!1),i=Object(W.a)(c,2),o=i[0],u=i[1];Object(r.useEffect)((function(){var e=E.getUserInfo(),n=t.user.id||t.user;u(n===e.id)}),[]);var l=Object(R.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)}}}}))();return Object(Q.jsxs)("div",{children:[Object(Q.jsx)("h1",{className:"title",children:t.title}),Object(Q.jsxs)("div",{className:"info",children:[Object(Q.jsx)(K.a,{href:t.id,underline:"hover",variant:"h6",children:t.url}),Object(Q.jsxs)(P.a,{variant:"h5",className:l.root,children:[Object(Q.jsxs)("span",{className:"likes",children:[t.likes," likes"]}),Object(Q.jsx)(q.a,{className:"like",onClick:function(){try{n((e=t.id,r=t.likes+1,function(){var t=Object(b.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E.update({id:e,likes:r});case 2:n({type:"LIKE_BLOG",data:{id:e,likes:r}});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),n(h("new like to blog ".concat(t.title," by ").concat(t.author)))}catch(a){n(p(a))}var e,r},variant:"contained",color:"primary",children:"Like"})]}),Object(Q.jsxs)(P.a,{className:"author",children:["added by ",t.author]}),o&&Object(Q.jsx)("button",{className:"remove",onClick:function(){var e;if(window.confirm("Remove ".concat(t.title," by ").concat(t.author,"?")))try{n(h("blog ".concat(t.title," by ").concat(t.author," delete"))),n((e=t.id,function(){var t=Object(b.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E.remove({id:e});case 2:n({type:"DELETE_BLOG",data:{id:e}});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),a.push("/")}catch(r){n(p(r))}},children:"remove"})]}),Object(Q.jsxs)("div",{className:"comments",children:[Object(Q.jsx)("h3",{children:"Comments"}),Object(Q.jsxs)("form",{onSubmit:function(e){var r,a;e.preventDefault(),n((r=t.id,a=e.target.comment.value,function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.newComment(r,a);case 2:n=e.sent,t({type:"COMMENT_BLOG",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),e.target.comment.value=""},className:l.root,children:[Object(Q.jsx)(H.a,{label:"Add Comment",variant:"outlined",type:"text",name:"comment"}),Object(Q.jsx)("div",{children:Object(Q.jsx)(q.a,{type:"submit",variant:"contained",color:"primary",children:"Submit"})})]}),Object(Q.jsx)("ul",{children:t.comments?t.comments.map((function(e){return Object(Q.jsx)("li",{children:e},e)})):Object(Q.jsx)("div",{children:" No comments "})})]})]})},Y=function(e){var t=e.message;return null===t?null:Object(Q.jsx)(P.a,{className:"message message-".concat(t.type),children:t.text})},Z=function(){var e=Object(s.b)(),t=Object(r.useState)(""),n=Object(W.a)(t,2),a=n[0],c=n[1],i=Object(r.useState)(""),o=Object(W.a)(i,2),u=o[0],l=o[1],d=Object(R.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)}}}}))();return Object(Q.jsx)("div",{children:Object(Q.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e(function(e,t){return function(){var n=Object(b.a)(j.a.mark((function n(r){var a;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,N.login({username:e,password:t});case 3:a=n.sent,window.localStorage.setItem("loggedBlogappUser",JSON.stringify(a)),E.setToken(a.token),r(U()),r(h("".concat(a.username," successfully logged in"))),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(0),r(p("Incorrect credentials"));case 13:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(e){return n.apply(this,arguments)}}()}(a,u)),c(""),l("")},className:d.root,children:[Object(Q.jsx)("div",{children:Object(Q.jsx)(H.a,{label:"Username",variant:"outlined",id:"username",value:a,onChange:function(e){var t=e.target;return c(t.value)}})}),Object(Q.jsx)("div",{children:Object(Q.jsx)(H.a,{label:"Password",variant:"outlined",id:"password",type:"password",value:u,onChange:function(e){var t=e.target;return l(t.value)}})}),Object(Q.jsx)(q.a,{id:"login-button",type:"submit",variant:"contained",color:"primary",children:"Login"})]})})},$=function(e){var t=e.createBlog,n=Object(r.useState)(""),a=Object(W.a)(n,2),c=a[0],i=a[1],s=Object(r.useState)(""),o=Object(W.a)(s,2),u=o[0],l=o[1],d=Object(r.useState)(""),j=Object(W.a)(d,2),b=j[0],f=j[1],h=Object(R.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)}}}}))();return Object(Q.jsx)("div",{className:"blogFormDiv",children:Object(Q.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t({title:c,author:u,url:b}),i(""),l(""),f("")},className:h.root,children:[Object(Q.jsx)("div",{children:Object(Q.jsx)(H.a,{label:"Title",variant:"outlined",id:"title",value:c,name:"title",onChange:function(e){var t=e.target;return i(t.value)}})}),Object(Q.jsx)("div",{children:Object(Q.jsx)(H.a,{label:"Author",variant:"outlined",id:"author",value:u,name:"author",onChange:function(e){var t=e.target;return l(t.value)}})}),Object(Q.jsx)("div",{children:Object(Q.jsx)(H.a,{label:"Url",variant:"outlined",id:"url",value:b,name:"url",onChange:function(e){var t=e.target;return f(t.value)}})}),Object(Q.jsx)(q.a,{id:"create-blog",type:"submit",variant:"contained",color:"primary",children:"Create"})]})})},ee=function(e){var t=e.createUser,n=Object(r.useState)(""),a=Object(W.a)(n,2),c=a[0],i=a[1],s=Object(r.useState)(""),o=Object(W.a)(s,2),u=o[0],l=o[1],d=Object(r.useState)(""),j=Object(W.a)(d,2),b=j[0],f=j[1],h=Object(R.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)}}}}))();return Object(Q.jsx)("div",{className:"blogFormDiv",children:Object(Q.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t({name:c,username:u,password:b}),i(""),l(""),f("")},className:h.root,children:[Object(Q.jsx)("div",{children:Object(Q.jsx)(H.a,{label:"Name",variant:"outlined",id:"name",value:c,name:"name",onChange:function(e){var t=e.target;return i(t.value)}})}),Object(Q.jsx)("div",{children:Object(Q.jsx)(H.a,{label:"Username",variant:"outlined",id:"username",value:u,name:"username",onChange:function(e){var t=e.target;return l(t.value)}})}),Object(Q.jsx)("div",{children:Object(Q.jsx)(H.a,{label:"Password",variant:"outlined",id:"password",value:b,name:"url",type:"password",onChange:function(e){var t=e.target;return f(t.value)}})}),Object(Q.jsx)(q.a,{id:"create-user",type:"submit",variant:"contained",color:"primary",children:"Create"})]})})},te=a.a.forwardRef((function(e,t){var n=Object(r.useState)(!1),a=Object(W.a)(n,2),c=a[0],i=a[1],s={display:c?"none":""},o={display:c?"":"none"},u=function(){i(!c)};Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:u}}));var l=Object(R.a)((function(e){return{spacing:{marginLeft:e.spacing(1)}}}))();return Object(Q.jsxs)("div",{children:[Object(Q.jsx)("div",{style:s,children:Object(Q.jsx)(q.a,{className:l.spacing,id:"create-blog",type:"submit",variant:"contained",color:"primary",onClick:u,children:e.buttonLabel})}),Object(Q.jsxs)("div",{style:o,children:[e.children,Object(Q.jsx)(q.a,{className:l.spacing,variant:"contained",color:"primary",onClick:u,children:"Cancel"})]})]})}));te.displayName="Togglable";var ne=te,re=n(146),ae=Object(G.a)((function(e){return{head:{backgroundColor:e.palette.warning.light,color:e.palette.common.white},body:{fontSize:14}}}))(I.a),ce=Object(G.a)((function(e){return{root:{"&:nth-of-type(odd)":{backgroundColor:e.palette.action.hover}}}}))(M.a),ie=Object(R.a)({table:{minWidth:700}}),se=function(){var e=ie(),t=Object(s.b)(),n=Object(s.c)((function(e){return e.allUsers})),a=Object(s.c)((function(e){return e.blogs}));return Object(r.useEffect)((function(){t(function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.getAllUsers();case 2:n=e.sent,t({type:"GET_USERS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[a]),Object(Q.jsxs)("div",{className:"users",children:[Object(Q.jsx)("h2",{children:"Users"}),n&&Object(Q.jsx)(z.a,{component:F.a,children:Object(Q.jsxs)(J.a,{className:e.table,"aria-label":"customized table",children:[Object(Q.jsx)(re.a,{children:Object(Q.jsxs)(M.a,{children:[Object(Q.jsx)(ae,{children:"User Name"}),Object(Q.jsx)(ae,{align:"right",children:"Blogs Created"})]})}),Object(Q.jsx)(V.a,{children:n.map((function(e){return Object(Q.jsxs)(ce,{children:[Object(Q.jsx)(ae,{component:"th",scope:"row",children:Object(Q.jsx)(o.b,{to:"/users/".concat(e.id),children:e.name})}),Object(Q.jsx)(ae,{align:"right",children:e.blogs.length})]},e.name)}))})]})})]})},oe=function(e){var t=e.blogs;if(!t[0])return Object(Q.jsx)("p",{children:"Loading..."});var n=Object(R.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)}}}}))();return Object(Q.jsxs)("div",{children:[Object(Q.jsx)("h2",{children:t[0].user.name}),Object(Q.jsx)(P.a,{children:"Added blogs"}),Object(Q.jsx)("ul",{children:t.map((function(e){return Object(Q.jsx)("li",{className:n.root,children:Object(Q.jsx)(K.a,{href:"/blogs/".concat(e.id),underline:"hover",variant:"h6",children:e.title})},e.id)}))})]})},ue=n(148),le=n(149),de=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.user})),n=Object(_.f)(),r=Object(R.a)((function(e){return{title:{flexGrow:1},rightButton:{marginLeft:e.spacing(2)},link:{textDecoration:"none",color:"#fff",paddingRight:"1em"},loggedText:{color:"grey"}}}))();return Object(Q.jsx)("div",{children:Object(Q.jsx)(ue.a,{position:"static",children:Object(Q.jsx)(le.a,{children:null!==t?Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsxs)(P.a,{variant:"h6",className:r.title,children:[Object(Q.jsx)(o.b,{className:r.link,to:"/",children:"Blogs"}),Object(Q.jsx)(o.b,{className:r.link,to:"/users",children:"Users"})]}),Object(Q.jsxs)(P.a,{variant:"overline",className:r.loggedText,children:[t.name," logged in"]}),Object(Q.jsx)(q.a,{variant:"outlined",color:"secondary",className:r.rightButton,onClick:function(){e((window.localStorage.removeItem("loggedBlogappUser"),{type:"LOGOUT_USER"})),n.push("/")},children:"Logout"})]}):Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsx)(P.a,{variant:"h5",className:r.title,children:"Blog App"}),Object(Q.jsx)(q.a,{variant:"outlined",className:r.rightButton,color:"secondary",onClick:function(){n.push("/login")},children:"Login"}),Object(Q.jsx)(q.a,{variant:"outlined",className:r.rightButton,color:"secondary",onClick:function(){n.push("/create-account")},children:"Create New Account"})]})})})})},je=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.blogs})),n=Object(s.c)((function(e){return e.notification})),a=Object(s.c)((function(e){return e.user})),c=Object(r.useRef)();Object(r.useEffect)((function(){e(U())}),[e]),Object(r.useEffect)((function(){e(function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[e]);var i=Object(_.g)("/users/:id"),u=i?t.filter((function(e){return e.user.id===i.params.id})):null,l=Object(_.g)("/blogs/:id"),d=l?t.find((function(e){return e.id===l.params.id})):null,f=Object(G.a)((function(e){return{head:{backgroundColor:e.palette.warning.light,color:e.palette.common.white},body:{fontSize:14}}}))(I.a),O=Object(G.a)((function(e){return{root:{"&:nth-of-type(odd)":{backgroundColor:e.palette.action.hover}}}}))(M.a),v=Object(R.a)({table:{minWidth:700}})();return Object(Q.jsxs)(D.a,{maxWidth:"xl",children:[Object(Q.jsx)(de,{}),Object(Q.jsx)(Y,{message:n}),Object(Q.jsxs)(_.c,{children:[Object(Q.jsx)(_.a,{path:"/users/:id",children:Object(Q.jsx)(oe,{blogs:u})}),Object(Q.jsx)(_.a,{path:"/blogs/:id",children:Object(Q.jsx)(X,{blog:d})}),Object(Q.jsx)(_.a,{path:"/users",children:null===a?Object(Q.jsx)(Z,{}):Object(Q.jsx)(se,{})}),Object(Q.jsx)(_.a,{path:"/create-account",children:Object(Q.jsx)(ee,{createUser:function(t){e(function(e){return function(){var t=Object(b.a)(j.a.mark((function t(n){var r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,C.createUser(e);case 3:r=t.sent,n({type:"CREATE_USER",data:r}),n(h("Account successfully created, please log-in")),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),n(p("Username must be unique, password must be longer than 3 characters, and all fields must be filled in"));case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()}(t))}})}),Object(Q.jsx)(_.a,{path:"/",children:null===a?Object(Q.jsx)("div",{children:Object(Q.jsx)(Z,{})}):Object(Q.jsxs)("div",{children:[Object(Q.jsx)("h2",{children:"Blogs"}),Object(Q.jsx)(ne,{buttonLabel:"Create Blog",ref:c,children:Object(Q.jsx)($,{createBlog:function(t){c.current.toggleVisibility(),e(function(e){return function(){var t=Object(b.a)(j.a.mark((function t(n){var r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,E.create(e);case 3:r=t.sent,n({type:"CREATE_BLOG",data:r}),n(h("a new blog ".concat(e.title," by ").concat(e.author," added"))),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),n(p("All fields must be filled in"));case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()}(t))}})}),Object(Q.jsx)(z.a,{component:F.a,children:Object(Q.jsx)(J.a,{className:v.table,"aria-label":"customized table",children:Object(Q.jsx)(V.a,{children:t.sort((function(e,t){return e.likes>t.likes?-1:1})).map((function(e){return Object(Q.jsx)(O,{children:Object(Q.jsx)(f,{component:"th",scope:"row",children:Object(Q.jsx)(o.b,{to:"/blogs/".concat(e.id),children:e.title})})},e.id)}))})})})]})})]})]})};n(106);i.a.render(Object(Q.jsx)(s.a,{store:A,children:Object(Q.jsx)(o.a,{children:Object(Q.jsx)(je,{})})}),document.getElementById("root"))}},[[107,1,2]]]);
//# sourceMappingURL=main.9005f988.chunk.js.map